/*
 * This file was generated by the Gradle 'init' task.
 */

plugins {
    id 'org.chuma.homecontroller.java-application-conventions'
}

dependencies {
    implementation project(':core')
    implementation project(':extensions')

    implementation 'org.apache.logging.log4j:log4j-core'
    implementation 'org.apache.logging.log4j:log4j-1.2-api'
    implementation group: 'com.luckycatlabs', name: 'SunriseSunsetCalculator'
    implementation group: 'org.eclipse.jetty', name: 'jetty-server'
    implementation group: 'org.apache.commons', name: 'commons-lang3'
    implementation 'org.chuma.hvac-controller:hvac-controller'

    winRxtx group: 'org.rxtx', name: 'rxtx', classifier: 'win64', ext: 'dll'
}

application {
    // Define the main class for the application.
    mainClass = 'org.chuma.homecontroller.app.Main'
    applicationName = "home-controller"
}

startScripts {
    doLast {
        // add rxtxSerial.dll to windows lib path
        // it is expected that rxtx is already installed on linux
        windowsScript.text = windowsScript.text.replace('set DEFAULT_JVM_OPTS=', 'set DEFAULT_JVM_OPTS="-Djava.library.path=%APP_HOME%\\lib"')
    }
}

distZip {
    into("$application.applicationName-$project.version/lib") {
        from configurations.winRxtx
        rename { String fileName ->
            fileName = "rxtxSerial.dll"
        }
    }
}
